<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
          "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>
<h2 class="probtitle">Problem K: ワープホール</h2>

<p>20XX年、遠く離れた場所に対する効率的な物質転送方式が確立され、人類の宇宙への進出はますます加速されることになった。この転送方式は、より遠くに物質を転送しようとすると、原則的により大きな物質の転送が可能になる点で革新的であった。転送方式の詳細を次に記す。</p>
<p>まず転送対象となる物質は、スタート座標(1, 1)にて単位質量毎のパーティクルに分割される。各パーティクルには、各々異なる波動エネルギーが与えられなければならない。波動エネルギーは、<i>V</i>と<i>H</i>からなる任意の長さの文字列で表現され、パーティクルの宇宙空間における漂い方を規定する。<i>V</i>は座標上(+1, 0)の移動を意味し、<i>H</i>は(0, +1)の移動を意味する。例えば、<i>VHHV</i>という波動エネルギーが与えられたパーティクルは、(2, 1), (2, 2), (2, 3) という軌跡で宇宙を漂った後、座標(3, 3)に辿り着く。</p>
<p>また、宇宙空間には複数のワープホールが存在し、パーティクルの軌跡に影響を与える。ワープホールには入口と出口があり、パーティクルがワープホールの入口に移動した場合、必ず出口の座標にワープすることになる。i番目のワープホールの入口と出口の座標を(a<sub>i</sub>, b<sub>i</sub>), (c<sub>i</sub>, d<sub>i</sub>)とすると、a<sub>i</sub> &le; c<sub>i</sub>, b<sub>i</sub> &le; d<sub>i</sub>, (a<sub>i</sub>, b<sub>i</sub>) &ne; (c<sub>i</sub>, d<sub>i</sub>)の条件が満たされており、ワープホールの入口は、他のワープホールの入口と同じ座標や、(1, 1)には存在しないことが保証されている。ただし、複数の出口が同じ場所にあったり、あるワープホールの出口に別のワープホールの入口がある場合はある(この場合は連続でワープする)。</p>
<p>例えば、(1, 2)を入口とし、(3, 2)を出口とするワープホールが存在した場合、<i>HH</i>と波動エネルギーを与えられたパーティクルは、(1, 2)へ移動後、(3, 2)へワープし、 (3, 3)へと辿り着く。</p>
<p>パーティクルは波動エネルギーを与えられると一瞬でそれに従って移動する。全てのパーティクルが同時に目的地点へ辿り着くと、自動的に元の物質へと再構成される。</p>
<p>あなたは宇宙開発機構のプログラマである。転送の目的座標 (N, M) と K 個のワープホールの座標対が与えられるので、一度に転送可能な物質の最大質量を求めるプログラムを書いてほしい。答えは非常に大きい数になる可能性があるため、1,000,000,007で割った余りを出力せよ。</p>

<h2>Input</h2>

<pre>
N M K
a<sub>1</sub> b<sub>1</sub> c<sub>1</sub> d<sub>1</sub>
...
a<sub>K</sub> b<sub>K</sub> c<sub>K</sub> d<sub>K</sub></pre>
<p>1 &le; N,M &le; 10<sup>5</sup>, 0 &le; K &le; 10<sup>3</sup> を満たす。また、
任意の 1 &le; i &le; K に対して a<sub>i</sub> &le; c<sub>i</sub>, b<sub>i</sub> &le; d<sub>i</sub>, (a<sub>i</sub>, b<sub>i</sub>) &ne; (c<sub>i</sub>, d<sub>i</sub>) を満たす。</p>

<h2>Output</h2>

<p>最大質量を 1,000,000,007 で割ったあまりを1行で出力せよ。
</p>

<h2>Sample Input 1</h2>
<pre>4 4 1
2 2 3 3
</pre>
<h2>Output for Sample Input 1</h2>
<pre>12
</pre>

<h2>Sample Input 2</h2>
<pre>1 4 1
1 2 1 3
</pre>
<h2>Output for Sample Input 2</h2>
<pre>1
</pre>

<h2>Sample Input 3</h2>
<pre>5 5 2
2 2 3 4
3 3 5 3
</pre>
<h2>Output for Sample Input 3</h2>
<pre>26
</pre>

<h2>Sample Input 4</h2>
<pre>5 5 3
4 4 5 5
2 2 3 3
3 3 4 4
</pre>
<h2>Output for Sample Input 4</h2>
<pre>18
</pre>

<h2>Sample Input 5</h2>
<pre>100000 100000 1
2 2 99999 99999
</pre>
<h2>Output for Sample Input 5</h2>
<pre>615667476
</pre>

<h2>Sample Input 6</h2>
<pre>1 1 0
</pre>
<h2>Output for Sample Input 6</h2>
<pre>1
</pre>



<hr>

<address>
Problemsetter: Yoichi Iwata
</address>
</body></html>
