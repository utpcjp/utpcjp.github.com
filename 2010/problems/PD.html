<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
          "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>
<h2 class="probtitle">Problem D: P=NP</h2>

<p>東京大学合格を目指す高校生のきたまさ君は入試問題に飽きてしまった。そこで、きたまさ君は入学前に大学で学ぶことの予習をしておこうと考えた。</p>
<p>きたまさ君は東京大学の生協に行き、教科書コーナーで面白そうな本を探すことにした。 様々な本のなかで、きたまさ君は計算量理論の本に興味を持ち、その本を読んでみることにした。</p>
<p>その本には次のようなことが書かれていた。 「グラフの彩色数を求める問題はNP困難である」</p>
<p>ところが、きたまさ君はグラフの彩色数を多項式時間で計算するアルゴリズムを思いついてしまった！これを用いるとP=NPであることが証明できる！！</p>
<p>きたまさ君はこの大発見を論文にしようと思ったのだが、残念ながらきたまさ君は日本語も英語もあまり得意ではないので、分かりやすくアルゴリズムを解説することができなかった。 そこで、きたまさ君は実際にこのアルゴリズムを実装して、無向グラフの彩色数を求めるプログラムを作り、それを公開することによって自分の正しさを示そうと考えた。 ちなみに、彩色数とは、グラフの頂点に 1～<i>K</i> の番号を振ったとき、辺で結ばれた頂点同士を全て異なる番号にできるような最小の <i>K</i> のことである。</p>
<p>また、多項式時間で動作していると主張するためには、グラフはとても大きくなければならないだろうときたまさ君は考え、次のようにして巨大グラフを生成することにした。</p>
<p>1. <i>N</i> 個の頂点<i>v</i><sub>0</sub>～<i>v</i><sub><i>N</i> -1</sub>を作る。</p>
<p>2. 線形合同法により長さ 2<i>M</i> の擬似乱数列 <i>x</i> を作成する。 具体的には次のような漸化式により、数列 <i>x</i><sub>0</sub>～<i>x</i><sub>2<i>M</i> -1</sub> を作成する。</p>
<blockquote><p><i>x</i><sub><i>i</i> +1</sub> = <i>a</i> <i>x<sub>i</sub></i> + <i>b</i> mod <i>N</i></p></blockquote>
<p>3. <i>i</i> = 0, 1, ..., <i>M</i> -1に対して、<i>x</i><sub>2<i>i</i></sub>&ne;
<i>x</i><sub>2<i>i</i> +1</sub>ならば、<i>x</i><sub>2<i>i</i></sub>番と<i>x</i><sub>2<i>i</i> +1</sub>番の頂点の間に辺を張る。 
</p>

<h2>Input</h2>

<p>入力は以下のような形式で与えられる。</p>
<pre><i>N</i> <i>M</i> <i>x</i><sub>0</sub> <i>a</i> <i>b</i></pre>
<p>1 &le; <i>N</i> &le; 10000, 1 &le; <i>M</i> &le; 1000000, 0 &le; <i>x</i><sub>0</sub>, <i>a</i>, <i>b</i> &lt; <i>N</i></p>
<p><i>N</i>, <i>M</i>, <i>x</i><sub>0</sub>, <i>a</i>, <i>b</i> の意味は問題文中の巨大グラフ生成アルゴリズムの説明を参照せよ。 
</p>

<h2>Output</h2>

<p>入力を用いて生成した巨大グラフの彩色数を一行に出力せよ。 
</p>

<h2>Sample Input 1</h2>
<pre>6 4 1 4 2
</pre>
<h2>Output for Sample Input 1</h2>
<pre>3
</pre>



<hr>

<address>
Problemsetter: Yoichi Iwata
</address>
</body></html>
