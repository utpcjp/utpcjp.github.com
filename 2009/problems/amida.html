<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
          "http://www.w3.org/TR/html4/strict.dtd">
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>
<h2 class="probtitle">Problem H: あみだくじ</h2>

<p>
なつめは大のねこ好きである。なつめは今日も日課としている野良ねこのブラッシングをするために，いつも野良ねこが集まってくる校庭の一角に向かうことにした。
</p>

<p>
そのスポットに今日は <var>n</var> 匹のねこが集まってきた。なつめは全員をブラッシングしてやりたかったのだが，ちょうどそこに来る直前に突然用事が出来てしまい，時間的に一匹しかブラッシングしてやれないことになってしまった。ブラッシングはどのねこも楽しみにしているので，一匹だけやると他のねこが嫉妬してしまう。そこでねこたちを納得させるために，どのねこをブラッシングするかをあみだくじで決めることにした。
</p>

<p>
あみだくじは <var>n</var> 本の縦線とあらかじめ引いた <var>m</var> 本の横線からなる。横線はとなりあう2本の縦線をそれらと垂直になるように結ばなければならない。また，横線同士が端点を共有してはいけない。ある1本の縦線の下端には当たりのマークがつけてある。これらの条件を満たすあみだくじの例を図に示す（これらはサンプル入力の例と対応している）。
</p>
<div style="text-align: center;">
<img alt="サンプル入力の例に挙げられたあみだくじの図" src="fig/amida.png"><br>
図: 問題の条件をみたすあみだくじの例
</div>

<p>
ねこたちはそれぞれ縦線の上端からどれか1つを選ぶ。そしてあみだくじを辿った結果，当たりをひいたねこが，今日のブラッシングをしてもらう権利を手に入れることができる，というルールである。なつめは早速あみだくじを作成した。縦線・横線・当たりを書き込み，横線が見えないように隠した。
</p>

<p>
いよいよねこたちに選んでもらおうという時になって，なつめは <var>n</var> 匹のねこの中に，普段は顔を見せない野良ねこのアクタガワがいることに気がついた。アクタガワはもう一ヶ月ほどブラッシングをしておらず，毛がごわごわしている。
</p>

<p>
なつめは他のねこたちには申し訳ないと思いながらも，ズルをしてアクタガワをブラッシングするように仕組むことにした。まず，ねこたちにそれぞれ普通通り縦線を選んでもらう。全員が選び終わったらなつめはこっそりといくつかの横線を追加し，アクタガワが当たるようにあみだくじを変更するのだ。
</p>

<p>
しかし，アクタガワが選んだ縦線によってはアクタガワを当たりにするために新たに引かなければならない横線が多すぎて，細工をしている間にねこたちに計画がバレてしまうかもしれない。そこでなつめはまずそれぞれの縦線について，アクタガワがそれを選んだ場合に何本の横線を引けば当たりにすることができるかを求めることにした。
</p>

<p>
なお，新たに引く横線も，となりあう2本の縦線をそれらと垂直に結ばなければならず，横線同士が端点を共有しないように引かなければならない。
</p>

<h2>Input</h2>
<p>
入力データは以下の形式で与えられる。
</p>

<div style="margin-left: 3em; margin-top: 1em; margin-bottom: 1em;">
<var>n</var> <var>m</var> <var>k</var><br>
<var>h</var><sub>1</sub> <var>x</var><sub>1</sub><br>
<var>h</var><sub>2</sub> <var>x</var><sub>2</sub><br>
...<br>
<var>h</var><sub><var>m</var></sub> <var>x</var><sub><var>m</var></sub>
</div>

<p>
入力の一行目には縦線の本数 <var>n</var> (1 &le; <var>n</var> &le; 100000)，すでに引かれている横線の本数 <var>m</var> (0 &le; <var>m</var> &le; 100000)，当たりの縦線の番号 <var>k</var> (1 &le; <var>k</var> &le; <var>n</var>) が与えられる。ここで，縦線の番号は，左から順に，1, 2, ..., <var>n</var> とする。
</p>

<p>
続く <var>m</var> 行には横線の情報が与えられる。各行は一つの横線の情報を表す二つの整数 <var>h</var> (1 &le; <var>h</var> &le; 1000000) 及び <var>x</var> (1 &le; <var>x</var> &le; <var>n</var> - 1) が与えられる。<var>h</var> は縦線の下端からの距離，<var>x</var> は横線によって結ばれる縦線のうち，左側の縦線の番号である。つまり，この横線は <var>x</var> 番目と <var>x</var>+1 番目の縦線を結ぶことになる。
</p>

<p>
なお、入力では横線は整数高さの位置にしか存在しないが、新たに追加する横棒の位置は必ずしも整数高さでなくてもよい。
</p>

<h2>Output</h2>
<p>
<var>n</var> 行の文字列を出力せよ。 <var>i</var>  (1 &le; <var>i</var> &le; <var>n</var>) 行目には，アクタガワが <var>i</var> 番目の縦線を選んだときに，アクタガワを当たりにするために追加する必要がある横線の最小本数を出力せよ。
</p>

<h2>Sample Input</h2>
<pre>3 2 1
20 1
10 2</pre>

<pre>5 7 3
70 1
60 4
50 2
40 4
30 1
20 3
10 2</pre>

<pre>1 0 1</pre>

<pre>4 2 1
10 1
10 3</pre>

<h2>Output for the Sample Input</h2>
<pre>1
0
1</pre>

<pre>1
0
1
1
2</pre>

<pre>0</pre>

<pre>1
0
1
2</pre>

<hr>

<address>
Problemsetter: Shuhei Takahashi
</address>
