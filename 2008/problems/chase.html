<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">

<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="Content-Style-Type" content="text/css">
    <title>Problem I: Aaron と Bruce</title>
    <style type="text/css">
      <!--
      h1 {
        text-align: center;
      }

      .timelimit {
        font-weight: bold;
	text-align: right;
      }

      .figure {
        text-align: center;
      }

      .figure table {
        margin-left: auto;
	margin-right: auto;
      }

      pre.sampleinput, pre.sampleoutput {
	padding: 0.5em;
        border: solid thin black;
      }

      .illust {
        margin-left: 3em;
	margin-right: 3em;
      }
      -->
    </style>
  </head>
  <h1>Problem I: Aaron と Bruce</h1>
  <p class="timelimit">Time Limit: 5 sec</p>

  <p>
    Aaron は凶悪な犯罪者である．
    彼は幾度も犯罪を繰り返しながら
    （万引き2回，のぞき16回，下着泥棒256回，食い逃げ65,536回）
    も，その人並み外れた身体能力を用いて
    警察の手から逃れ続けてきた．
    Bruce は警察官である．
    彼は突出した運動能力は持っていないが，
    写真撮影が趣味であり，
    彼の撮った写真が雑誌に載るほどの腕前を持っている．
  </p>

  <p>
    ある日，Bruce は山奥に写真撮影をしに来た．
    すると偶然 Aaron のアジトを突き止めてしまった．
    Bruce が逃げる Aaron を追っていくと，
    彼らは落とし穴に落ちて古代遺跡の中に迷い込んでしまった．
  </p>

  <p>
    古代遺跡の中はいくつかの部屋と，部屋どうしを結ぶ通路で構成されている．
    古代遺跡に <var>M</var> 個の部屋があるとき，
    遺跡内の部屋にはそれぞれ 0 から <var>M</var>−1 までの番号がつけられている．
  </p>

  <p>
    Aaron は逃げている間に時効を迎えるかもしれないと考えたので，
    Bruce が最適に移動したときに一番長い間逃げ続けられるように
    遺跡の中を移動する．
    Bruce は早く Aaron を写真に収めたいので，
    Aaron が最適に移動したときに一番早く Bruce を写真に収められるように
    遺跡の中を移動する．
  </p>

  <p>
    Aaron と Bruce は順番に行動する．
    最初は Aaron の番とする．
    それぞれの順番のとき，隣接している部屋のどれか1つに移動，
    もしくはその場にとどまることができる．
    Aaron と Bruce が同じ部屋に入ったとき，
    Bruce は Aaron を撮影するものとする．
  </p>

  <p>
    Bruce が Aaron を撮影するのにどれくらいの時間がかかるかを求めて欲しい．
    時間はターン数で表すこととし，
    Aaron と Bruce がともに1回行動し終わったら1ターンと数える．
  </p>

  <p>
    例えば，図5のような状況のとき，
    Aaron は部屋5に逃げ込めば Bruce は4ターンでたどり着くが，
    Aaron が部屋7に逃げ込めば Bruce はたどり着くのに5ターンかかる．
    Aaron にとっては部屋7に逃げ込むことで一番長く逃げ続けられるので
    答えは5ターンとなる．
  </p>

  <div class="figure">
    <table>
      <tbody>
	<tr>
	  <td>
	    <img src="img/chase.1.png"
		 alt="Aaron が5ターン逃げ続けられる例．">
	  </td>
	</tr>
	<tr>
	  <td>図5: Aaron が5ターン逃げ続けられる例．</td>
	</tr>
      </tbody>
    </table>
  </div>

  <p>
    また，図6のような状況のとき，
    Aaron が Bruce から遠ざかるように部屋を移動することで
    いつまでも逃げ回ることができる．
  </p>

  <div class="figure">
    <table>
      <tbody>
	<tr>
	  <td>
	    <img src="img/chase.2.png"
		 alt="Aaron がいつまでも逃げ続けられる例．">
	  </td>
	</tr>
	<tr>
	  <td>図6: Aaron がいつまでも逃げ続けられる例．</td>
	</tr>
      </tbody>
    </table>
  </div>

  <h2>Input</h2>
  <p>
    入力の最初の行にデータセット数を表す数 <var>N</var>
    (0 &lt; <var>N</var> &le; 100) が与えられる．
    次の行から <var>N</var> 個のデータセットが続く．
  </p>

  <p>
    各データセットは古代遺跡の形状と Aaron と Bruce の初期位置からなる．
    初めに，古代遺跡の部屋の数 <var>M</var>
    (2 &le; <var>M</var> &le; 50) が与えられる．
    次に要素数 <var>M</var> &times; <var>M</var> の行列が与えられる．
    各行列の要素は 0 もしくは 1 であり，
    <var>i</var> 行目の <var>j</var> 番目の数字が 1 ならば，
    部屋 <var>i</var> と部屋 <var>j</var>
    は通路でつながっているということを意味する
    （ただし，行列の行番号と列番号は0から数える）．
    行列の (<var>i</var>, <var>j</var>) 成分と
    (<var>j</var>, <var>i</var>) 成分の値は必ず等しく，
    (<var>i</var>, <var>i</var>) 成分の値は 0 である．
    続いて，2つの整数 <var>a</var>, <var>b</var> が与えられる．
    各整数はそれぞれ Aaron の初期位置の部屋番号
    (0 &le; <var>a</var> &lt; <var>M</var>) と
    Bruce の初期位置の部屋番号
    (0 &le; <var>b</var> &lt; <var>M</var>) を示す．
    <var>a</var> と <var>b</var> の値は必ず異なる．
  </p>

  <h2>Output</h2>
  <p>
    各データセットごとに，Bruce が Aaron を撮影するのに何ターンかかるかを
    1行で出力せよ．
    どれだけたっても撮影できない場合は
    &ldquo;<code>infinity</code>&rdquo; と出力せよ．
  </p>

  <h2>Sample Input</h2>
  <pre class="sampleinput">6
8
0 1 0 0 0 0 0 0
1 0 1 0 0 0 0 0
0 1 0 1 1 0 0 0
0 0 1 0 0 0 0 0
0 0 1 0 0 1 1 0
0 0 0 0 1 0 0 0
0 0 0 0 1 0 0 1
0 0 0 0 0 0 1 0
3 0
4
0 1 1 0
1 0 0 1
1 0 0 1
0 1 1 0
1 0
5
0 1 0 1 0
1 0 0 1 0
0 0 0 0 1
1 1 0 0 0
0 0 1 0 0
2 0
5
0 1 0 0 1
1 0 1 1 1
0 1 0 1 0
0 1 1 0 1
1 1 0 1 0
2 4
5
0 1 0 1 0
1 0 1 1 0
0 1 0 0 1
1 1 0 0 1
0 0 1 1 0
3 0
5
0 1 0 1 1
1 0 1 0 1
0 1 0 1 0
1 0 1 0 1
1 1 0 1 0
0 4</pre>

  <h2>Output for the Sample Input</h2>
  <pre class="sampleoutput">5
infinity
infinity
2
infinity
1</pre>

  <hr>
  <address>
    東京大学プログラミングコンテスト2008<br>
    Problemsetter: Ben Hachimori
  </address>
</html>
